<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />

<title>AppsApp - An Unhosted demo</title>
<script src="jquery.js"></script>
<script>
if(window.location != 'http://appsapp.org/?user_address=don@federoni.org&view=public') {
	window.location = 'http://appsapp.org/?user_address=don@federoni.org&view=public';
}
$.ajax({
	url: 'http://federoni.org/webdav/federoni.org/don/apps/public',
	dataType: 'text',
	success: function(dataTxt) {
		data = JSON.parse(dataTxt);
		//display first app icon if it is of type hosted:
		if(data.apps[0].type == 'hosted') {
			$.ajax({
				url: 'http://federoni.org/webdav/federoni.org/don/apps/'+data.apps[0].hash+'/manifest.json',
				dataType: 'text',
				success: function(manifestTxt) {
					manifest = JSON.parse(manifestTxt);
					$('#icon1').attr('src', 
						'http://federoni.org/webdav/federoni.org/don/apps/'
						+ data.apps[0].hash + '/' + manifest.icons['128']);
					$('#link1').attr('href', manifest.app.launch.web_url);
				},
				error: function(jqXHR) {
					alert('oops');
				}
			});
		}
	},
	error: function(jqXHR) {
		alert('oops');
	}
});
</script>
</head>
<body>
<div>
<a id="link1" target="_blank"><img id="icon1"></a>
</div>
</body>
</html>
